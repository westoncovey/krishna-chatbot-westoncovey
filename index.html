<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Conversation with Krishna – Bhagavad Gita Chatbot</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <style>
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
    }

    body {
      background: #020617;
      color: #f9fafb;
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 20px;
    }

    .app {
      width: 100%;
      max-width: 900px;
      background: #020617;
      border-radius: 14px;
      box-shadow: 0 14px 28px rgba(0, 0, 0, 0.7);
      display: grid;
      grid-template-columns: minmax(0, 3fr) minmax(0, 2fr);
      overflow: hidden;
      border: 1px solid #1f2937;
    }

    @media (max-width: 800px) {
      .app {
        grid-template-columns: minmax(0, 1fr);
      }
      .sidebar {
        display: none;
      }
    }

    .chat-section {
      display: flex;
      flex-direction: column;
      height: 540px;
      background: radial-gradient(circle at top, #111827, #020617 70%);
    }

    .header {
      padding: 16px 18px;
      border-bottom: 1px solid #1f2937;
      display: flex;
      align-items: center;
      gap: 10px;
      background: #020617;
    }

    .avatar {
      width: 38px;
      height: 38px;
      border-radius: 999px;
      background: #f97316;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 20px;
      border: 2px solid #fed7aa;
    }

    .header-text h1 {
      font-size: 1.05rem;
      font-weight: 600;
    }

    .header-text p {
      font-size: 0.8rem;
      color: #9ca3af;
    }

    .chat-window {
      flex: 1;
      padding: 16px 18px;
      overflow-y: auto;
    }

    .message {
      max-width: 85%;
      margin-bottom: 14px;
      padding: 9px 12px;
      border-radius: 12px;
      font-size: 0.9rem;
      line-height: 1.4;
      position: relative;
    }

    .message.user {
      margin-left: auto;
      background: #1d4ed8;
      color: #f9fafb;
      border-bottom-right-radius: 4px;
    }

    .message.krishna {
      margin-right: auto;
      background: #020617;
      border: 1px solid #1f2937;
      border-bottom-left-radius: 4px;
    }

    .message small {
      display: block;
      margin-top: 5px;
      font-size: 0.7rem;
      opacity: 0.7;
    }

    .input-area {
      padding: 12px 14px;
      border-top: 1px solid #1f2937;
      background: #020617;
      display: flex;
      gap: 10px;
      align-items: flex-end;
    }

    textarea {
      flex: 1;
      resize: none;
      border-radius: 10px;
      border: 1px solid #374151;
      padding: 8px 10px;
      min-height: 40px;
      max-height: 110px;
      background: #020617;
      color: #e5e7eb;
      font-size: 0.9rem;
    }

    textarea:focus {
      outline: none;
      border-color: #60a5fa;
    }

    button {
      border: none;
      border-radius: 999px;
      padding: 9px 16px;
      font-size: 0.9rem;
      font-weight: 500;
      cursor: pointer;
      background: #f59e0b;
      color: #111827;
      display: inline-flex;
      align-items: center;
      gap: 6px;
      white-space: nowrap;
    }

    button:hover {
      filter: brightness(1.03);
    }

    .sidebar {
      padding: 16px 16px 14px;
      background: #020617;
      border-left: 1px solid #1f2937;
      display: flex;
      flex-direction: column;
      gap: 14px;
      font-size: 0.86rem;
    }

    .sidebar h2 {
      font-size: 0.96rem;
      margin-bottom: 4px;
    }

    .card {
      background: #020617;
      border-radius: 12px;
      padding: 9px 11px;
      border: 1px solid #111827;
    }

    .badge {
      display: inline-block;
      padding: 3px 8px;
      border-radius: 999px;
      font-size: 0.7rem;
      text-transform: uppercase;
      letter-spacing: 0.06em;
      background: #111827;
      color: #e5e7eb;
      margin-bottom: 4px;
    }

    ul {
      padding-left: 16px;
      margin-top: 4px;
    }

    li {
      margin-bottom: 4px;
      color: #d1d5db;
    }

    .examples {
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
      margin-top: 6px;
    }

    .examples button {
      margin: 0;
      padding: 5px 10px;
      border-radius: 999px;
      border: 1px solid #4b5563;
      background: transparent;
      color: #e5e7eb;
      font-size: 0.8rem;
    }

    .examples button:hover {
      background: #111827;
    }
  </style>
</head>
<body>
  <div class="app">
    <section class="chat-section">
      <header class="header">
        <div class="avatar">ॐ</div>
        <div class="header-text">
          <h1>Talk with Krishna</h1>
          <p>Simple Bhagavad Gita chatbot for Weston Covey's final project</p>
        </div>
      </header>

      <main class="chat-window" id="chatWindow">
        <div class="message krishna">
          Welcome, Arjuna, Jenny, and all who seek guidance. Ask what troubles your heart...
          <small>Krishna · Bhagavad Gita inspired</small>
        </div>
      </main>

      <form class="input-area" id="chatForm">
        <textarea
          id="userInput"
          placeholder="Ask Krishna a question, for example: What is my purpose?"
        ></textarea>
        <button type="submit">
          Send
        </button>
      </form>
    </section>

    <aside class="sidebar">
      <div class="card">
        <span class="badge">Project overview</span>
        <h2>Bhagavad Gita Chatbot</h2>
        <p>
          This is a small class project where I turned a few big ideas from the
          Bhagavad Gita into a rule-based chatbot. The user types as if they are
          Arjuna, and “Krishna” answers using short lines and ideas that come from
          the text and from my notes.
        </p>
      </div>

      <div class="card">
        <span class="badge">Things you can ask about</span>
        <p>Try questions connected to these themes:</p>
        <div class="examples">
          <button type="button" data-example="What is my purpose in life?">
            Purpose and calling
          </button>
          <button type="button" data-example="How can I be happy?">
            Happiness and peace
          </button>
          <button type="button" data-example="I am scared of failing.">
            Fear and failure
          </button>
          <button type="button" data-example="Why should I do my duty?">
            Duty and responsibility
          </button>
        </div>
      </div>

      <div class="card">
        <span class="badge">How it works</span>
        <ul>
          <li>Made by Weston Covey for LITHUM Final Project - Jennifer Rhodes</li>
          <li>
            Have you ever wanted to be like Arjuna and ask Krishan a deep question from your heart? Well, now you can.
          </li>
          <li>
            Some lines are direct quotes from the Gita, others are my
            paraphrases to make the ideas shorter and clearer.
          </li>
        </ul>
      </div>
    </aside>
  </div>

  <script>
    // Core themes and response bank, loosely based on the Gita
    const krishnaResponses = [
      {
        theme: "purpose",
        keywords: ["purpose", "meaning", "why am I here", "what am I here", "life meaning"],
        replies: [
          `Your purpose is not found in random desires but in your deepest duty. Focus on what is in front of you and act with sincerity, without clinging to the result.`,
          `You are here to act, to learn, and to grow in wisdom and love. Do your work as an offering, not as a way to feed your ego.`,
          `Do not be lost in the question “Who am I” forever. Do the right action in this moment, and your path will slowly reveal itself.`,
          `"You have the right to work, but never to the fruit of work. Perform work in this world without selfish attachments." - Bhagavad Gita 2.47`,
          `"It is better to strive in one's own dharma than to succeed in the dharma of another" - Bhagavad Gita 3.35`,
          `Your purpose is awakened when you choose truth over comfort and action over hesitation.`,
          `Walk your path with integrity, and clarity will rise within you.`
        ]
      },
      {
        theme: "happiness",
        keywords: ["happy", "happiness", "joy", "sad", "depressed", "empty"],
        replies: [
          `Seeking happiness only in outside things brings endless restlessness. Lasting peace comes when you act well and let go of constant craving for specific outcomes.`,
          `You suffer because your mind runs after what changes. Turn a part of your attention inward, act rightly, and accept that gain and loss always come and go.`,
          `True peace begins when you stop trying to control everything. Do your best, be steady in success and failure, and you will taste a deeper kind of happiness.`,
          `"Pleasure and pain come and go like the seasons. Endure them without being disturbed." - Bhagavad Gita 2`,
          `"They are forever free who renounce all selfish desires and break away from the egocage of "I, "me," and "mine" to be united with the Lord." - Bhagavad Gita 2.71`,
          `"Having attained that abiding joy beyond the senses, revealed in the silled mind, they never swerve from the eternal truth." - Bhagavad Gita 6.21`,
          `Happiness grows where expectation weakens, and gratitude deepens.`,
          `Peace begins when you stop letting every outcome decide your worth.`
        ]
      },
      {
        theme: "fear",
        keywords: ["fear", "afraid", "scared", "anxious", "anxiety", "worry"],
        replies: [
          `Fear grows when you stare only at the future. Bring your mind back to your present duty and do that well. Courage is born in focused action.`,
          `You are not as fragile as your fear suggests. Act with the best wisdom you have, accept what you cannot control, and remember that no outcome can touch your inner self.`,
          `Do not let fear paralyze you before the battle even begins. Step forward, one action at a time, and your strength will rise to meet you.`,
          `"Remembering me, you shall overcome all difficulties through my grace." - Bhagavad Gita 18.58`,
          `"Nothing in this world purifies like spiritual wisdom." - Bhagavad Gita 4.38`,
          `Fear fades when you anchor your mind to what is real and let the imagined drift away.`,
          `Act with courage even when courage feels small; this is how strength is born.`
        ]
      },
      {
        theme: "duty",
        keywords: ["duty", "work", "job", "responsibility", "obligation", "career"],
        replies: [
          `It is better to do your own duty imperfectly than to live someone else’s life perfectly. Do what is yours to do, even when it is hard.`,
          `Do your work without building your identity on the result. You control the action you take, not the full outcome of events.`,
          `When you treat your duties as an offering, even simple tasks become a path toward inner clarity instead of a burden.`
        ]
      },
      {
        theme: "failure",
        keywords: ["fail", "failure", "mistake", "mess up", "loser"],
        replies: [
          `Failure in outward action is not failure of the soul. If you learn and stand up again, you are still moving on the path.`,
          `Do not worship success and fear failure as a god. Offer your best effort, accept the result, and use every outcome as a lesson.`,
          `What you call failure is only one moment on a long road. Stay steady, correct your course, and keep walking.`
        ]
      },
      {
        theme: "attachment",
        keywords: ["attachment", "addicted", "obsessed", "let go", "cling", "clinging"],
        replies: [
          `Pain grows where attachment is tight. Love and act, but do not build your whole identity on having a specific outcome.`,
          `Act with full effort, but release the constant need to control what follows. This is the heart of detachment.`,
          `When you let go of clinging, you are not becoming cold. You are freeing yourself to act with clarity instead of fear.`
        ]
      },
      {
        theme: "general",
        keywords: [],
        replies: [
          `Steady your mind, do the right thing that lies in front of you, and do not be shaken by every passing rise and fall.`,
          `Act with courage, speak truthfully, and let go of the constant need to control every result. That is enough for this moment.`,
          `Do not wait for perfect certainty before you move. Walk the path one honest step at a time, and wisdom will grow within you.`
        ]
      }
    ];

    // NEW: track which themes have already used a quote
    const usedQuote = {};

    function getKrishnaReply(userText) {
      const text = userText.toLowerCase();

      for (const block of krishnaResponses) {
        if (block.theme === "general") continue;
        if (block.keywords.some(kw => text.includes(kw))) {

          // find quote replies
          const quoteReplies = block.replies.filter(r => r.includes("Bhagavad Gita"));

          // if theme has a quote AND we haven't used it yet, use it first
          if (quoteReplies.length && !usedQuote[block.theme]) {
            usedQuote[block.theme] = true;
            return { reply: quoteReplies[0], theme: block.theme };
          }

          // otherwise random from all replies
          const replies = block.replies;
          const randomIndex = Math.floor(Math.random() * replies.length);
          return { reply: replies[randomIndex], theme: block.theme };
        }
      }

      // fallback to general
      const generalBlock = krishnaResponses.find(b => b.theme === "general");
      const randomIndex = Math.floor(Math.random() * generalBlock.replies.length);
      return { reply: generalBlock.replies[randomIndex], theme: "general" };
    }

    const chatWindow = document.getElementById("chatWindow");
    const chatForm = document.getElementById("chatForm");
    const userInput = document.getElementById("userInput");

    function appendMessage(text, sender = "user", meta = "") {
      const msg = document.createElement("div");
      msg.classList.add("message", sender);
      msg.innerHTML = text.replace(/\n/g, "<br>");
      if (meta) {
        const small = document.createElement("small");
        small.textContent = meta;
        msg.appendChild(small);
      }
      chatWindow.appendChild(msg);
      chatWindow.scrollTop = chatWindow.scrollHeight;
    }

    chatForm.addEventListener("submit", function (e) {
      e.preventDefault();
      const text = userInput.value.trim();
      if (!text) return;

      appendMessage(text, "user", "You");
      userInput.value = "";

      setTimeout(() => {
        const { reply, theme } = getKrishnaReply(text);
        const meta = `Krishna · theme: ${theme}`;
        appendMessage(reply, "krishna", meta);
      }, 500);
    });

    document.querySelectorAll("[data-example]").forEach(btn => {
      btn.addEventListener("click", () => {
        const text = btn.getAttribute("data-example");
        userInput.value = text;
        userInput.focus();
      });
    });
  </script>
</body>
</html>
